<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Disease Insights</title>
    {% load static %}
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css" integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" href="{% static 'css/style.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'css/font-awesome.min.css' %}">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.3/Chart.min.css" rel="stylesheet" type="text/css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.3/Chart.min.js"></script>
    <link rel="stylesheet" href="{% static 'css/areaReport.css'%}">
</head>
<body id="myPage">
  <script>
    // pincode_final={{pincode}};
    diseases_final={{diseases_json|safe}};
  </script>
    <main class="d-block">
        <nav class="navbar navbar-expand-lg fixed-top" style="background-color: rgba(28,74,90, 0.9) ;">
            <a class="navbar-brand text-light" href="#">Disease REPORTING</a>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
              <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarSupportedContent">
                <ul class="navbar-nav ml-auto">
                  <li class="nav-item active">
                    <a class="nav-link text-light" href="#banner">Home <span class="sr-only">(current)</span></a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link text-light" href="#service">Services</a>
                  </li>
                </ul>
            </div>
          </nav>
          <!-- TODO: {pincode:'751004'} is the parameter type for calling the area API -->
          <section class="report-area">
            <div class="container mb-5">
                <h2 class="ser-title">Search Any Other Location</h2> 
                  <hr class="botm-line w-25">
              <div class="row">
                <div class="col-md-12 ">
                  <select class="custom-select form-control rounded w-75 my-auto" id="inputGroupSelect">
                    <option selected disabled></option>
                    {% for pincode in pincodes %}
                    <option value="{{ pincode.pincode }}">{{ pincode.district.name|capfirst }}, {{ pincode.pincode }}</option>
                    {% endfor %}
                    <!-- <option value="2">Two</option>
                      <option value="3">Three</option> -->
                    </select>
                    <button class="btn btn-outline-success rounded-pill px-5 ml-2" onclick="searchLocation()">Search</button>
                  </div>
              </div>
            </div>
            <div class="col-md-12">
              <h2 class="ser-title">{{ pincode_details.district.name }} </h2> <!--? Loaction to be dynamic-->
              <hr class="botm-line">
            </div>
            <div class="alert alert-{{ diseases.0.warning}} ml-5 " role="alert">
                {% if diseases.0.warning == 'success' %}
                <h4 class="alert-heading">Safe Location</h4>
                <p>Your destination is completely safe for you to visit. Any future probable health hazards will be notified to you via our mobile app during your stay at {{pincode}}</p>
                <hr>
                <p class="mb-0">Happy and safe journey!</p>
                {% elif diseases.0.warning == 'warning' %}
                <h4 class="alert-heading">Moderately Safe Location</h4>
                <p>Your destination is mildly contaminated with diseases which might create health issues for you. You are requested to have precautional look at them below for further details before you visit {{pincode}}</p>
                <hr>
                <p class="mb-0">{{pincode_details.district.name}} is safe to visit but with certain limitations. Happy and safe journey!</p>
                {% else %}
                <h4 class="alert-heading">Not Safe Location</h4>
                <p>Your destination is unsafe for visit due the contagious spread of certain diseases at {{pincode_details.district.name}}. So it is advisable to cancel your visit.</p>
                <hr>
                <p class="mb-0">Please refer the below given data to know more about the health hazards at {{pincode_details.district.name}}</p>
                {% endif %}
              </div>
              
            <!--?Details reagarding -->
        </section>
        <!-- ? Graph section -->
        {% if diseases %}
        <div class="container">
          <main>
              <div class="dashboard-container">
                  <div class="card-1">
                      <h4 class="chart-lbl">
                          Vulnerability of diseases in {{pincode}}
                      </h4>
                      <div class="divider">
                      </div>
                      <div class="doughnut-chart-container">
                          <canvas class="doughnut-chart" id="doughnut">
                          </canvas>
                      </div>
                  </div>
                  <div class="card-2">
                      <h4 class="chart-lbl">
                          How many people dropped plan to visit {{pincode}}
                      </h4>
                      <div class="divider">
                      </div>
                      <div class="pie-chart-container">
                          <canvas class="pie-chart" id="pie">
                          </canvas>
                      </div>
                  </div>
                  <div class="card-3">
                      <h4 class="chart-lbl">
                          Diseaases
                      </h4>
                      <div class="divider">
                      </div>
                      <div class="bar-chart-container">
                          <canvas class="bar-chart" id="bar">
                          </canvas>
                      </div>
                  </div>
              </div>
          </main>
      </div>
          <section class='mb-5' style="position:absolute;top: 60%;left: 20%;"> 
            <div class="row">
              {% for disease in diseases%}
              <div class="disease-container my-5">
                    <div class="disease-card">
                    <div class="type w-25">
                      <h1 class="text-light">{{disease.disease.disease_name }}</h1>
                      <p><strong class="text-uppercase">symptoms: </strong>{{disease.disease.info_symptoms}}</p>
                      <p><strong class="text-uppercase">How it spreads: </strong>{{disease.disease.info_spread}}</p>
                      <p><strong class="text-uppercase">Precautional measures: </strong>{{disease.disease.info_precautions}}</p>
                      <p><strong class="text-uppercase">Managerial Information: </strong>{{disease.disease.info_managerial}}</p>
                      <p><strong class="text-uppercase">Diagnostic Information: </strong>{{disease.disease.info_diagnostic}}</p>                        {% if disease.disease.vacination_available %}
                        <p class="text-success">Vaccine is available</p>
                        {% else %}
                        <p class="text-warning">Vaccine is not available</p>
                        {% endif %}
                        {% if disease.disease.zoonotic %}
                        <p class="text-warning">Its a zoonotic disease</p>
                        {% else %}
                        <p class="text-success">Its not a zoonotic disease</p>
                        {% endif %}
                      <a href="{{disease.disease.info_url}}" target="_blank"><button >Read More</button></a>
                    </div>
                    <div class="stats">
                      <div class="clientrev text-center">
                        <span>{{disease.disease.mortality}}</span>
                        <p>mortality rate</p>
                      </div>
                      <div class="adspend text-center">
                        <span>{{disease.disease.morbidity}}</span>
                        <p>morbidity rate</p>
                      </div>
                      <div class="maus text-center">
                        <span>{{disease.disease.suseptible_prone_age}}</span>
                        <p>susceptible age-group</p>
                      </div>
                      <div class="roi text-center">
                        <span>{{disease.disease.category}}</span>
                        <p>Mode of transmission
                        </p>
                      </div>
                    </div>
                  </div>
                  </div>
                  {% endfor %}
            </div>
          </section>
          {% endif %}

</main>
<script>
      function searchLocation() {
        console.log('Searching')
        pincode = $('#inputGroupSelect').val();
        window.location = `/area/${pincode.trim()}`
    }

</script>
<script src="{% static 'js/jquery.min.js' %}"></script>
<script src="{% static 'js/jquery.easing.min.js' %}"></script>
<script src="{% static 'js/bootstrap.min.js' %}"></script>
<script src="{% static 'js/chart.js' %}"></script>
<script src="{% static 'js/areaReport.js' %}"></script>
</body>
</html>